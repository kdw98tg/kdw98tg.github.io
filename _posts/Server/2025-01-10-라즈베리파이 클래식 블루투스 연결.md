---
title: "[raspberri pi] Raspberry pi ì™€ Window ë¸”ë£¨íˆ¬ìŠ¤ í†µì‹ í•˜ê¸° (í´ë˜ì‹)"

categories:
  -  Server
  
tags:
  - [Raspberrypi, Linux, Window, Bluetooth]

toc: true
toc_sticky: true

published: true

date: 2025-01-10
last_modified_at: 2025-01-10
---

ë¼ì¦ˆë² ë¦¬íŒŒì´ 5ë¥¼ í™œìš©í•˜ì—¬ ë¸”ë£¨íˆ¬ìŠ¤ ì„œë²„ë¥¼ ì—´ê³ , Winform ìœ¼ë¡œ í”„ë¡œê·¸ë¨ì„ ì§œì„œ í•´ë‹¹ ë°ì´í„°ë¥¼ ìˆ˜ì‹ í•˜ëŠ” ê³¼ì •ì„ ê¸°ìˆ í•˜ì˜€ìŠµë‹ˆë‹¤.

ë¼ì¦ˆë² ë¦¬íŒŒì´ì—ì„œëŠ” python ì½”ë“œë¥¼ ê°€ì§€ê³  ì„œë²„ë¥¼ ì—´ì—ˆìŠµë‹ˆë‹¤. ë˜í•œ, ê°€ìƒí™˜ê²½ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

## ë¼ì¦ˆë² ë¦¬íŒŒì´ ì„¸íŒ…í•˜ê¸°

### 1. ë¸”ë£¨íˆ¬ìŠ¤ ëª¨ë“ˆ ì„¤ì¹˜

ë¸”ë£¨íˆ¬ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ëª¨ë“ˆë“¤ì„ ìš°ì„  ë‹¤ìš´ë¡œë“œ í•©ë‹ˆë‹¤.

```bash
$sudo apt-get install bluez libbluetooth-dev pi-bluetooth
```

### 2. Python ì„¤ì¹˜

ê°€ìƒí™˜ê²½ì„ ë§Œë“¤ê³ , Pythonì„ ì„¤ì¹˜ í•©ë‹ˆë‹¤. 

íŒŒì´ì¬ ê´€ë ¨ ìœ í‹¸ë¦¬í‹°ê°€ ì„¤ì¹˜ê°€ ëœ ìƒíƒœì—ì„œ íŒŒì´ì¬ì„ ì¬ë¹Œë“œí•´ì„œ ì„¤ì¹˜í•´ì•¼ ì´í›„ì— ë¸”ë£¨íˆ¬ìŠ¤ ê´€ë ¨ ëª¨ë“ˆì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒì˜ ëª…ë ¹ì–´ë“¤ì„ ë„£ìŠµë‹ˆë‹¤.

```bash
$mkdir temp
$cd temp
$wget https://www.python.org/ftp/python/3.6.5/Python-3.6.5.tgz
$tar -xvf Python-3.6.5.tgz
 
$cd Python-3.6.5
$./configure
$sudo make && sudo make install
```

ì´ë ‡ê²Œí•˜ë©´ ìë™ìœ¼ë¡œ temp í´ë”ë¥¼ ë§Œë“¤ê³ , pythonì„ ì„¤ì¹˜í•˜ê²Œ ë©ë‹ˆë‹¤. ì•½ 10ë¶„ì •ë„ ì†Œìš”ë©ë‹ˆë‹¤.

### 3. ì‹œë¦¬ì–¼  í¬íŠ¸ ë“±ë¡

í†µì‹ ì„ í•˜ê¸° ìœ„í•œ ì‹œë¦¬ì–¼ í¬íŠ¸ë¥¼ ë“±ë¡ í•©ë‹ˆë‹¤.

```bash
$sudoÂ sdptoolÂ addÂ SP
```

### 4. ë¸”ë£¨íˆ¬ìŠ¤ ì„¤ì •íŒŒì¼ ìˆ˜ì •

nano í…ìŠ¤íŠ¸ í¸ì§‘ê¸°ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¸”ë£¨íˆ¬ìŠ¤ì˜ ì„¤ì •íŒŒì¼ì„ ìˆ˜ì •í•´ ì¤ë‹ˆë‹¤.

```bash
$sudoÂ nanoÂ /lib/systemd/system/bluetooth.service
```

í•´ë‹¹ ëª…ë ¹ì–´ë¡œ `bluetooth.service`ë¥¼ ì—´ì–´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸êµ¬ê°€ ìˆìŠµë‹ˆë‹¤.

```bash
$ExecStart=/usr/lib/bluetooth/bluetoothd
```

í•´ë‹¹ ë¬¸êµ¬ë¥¼ ì•„ë˜ì™€ ê°™ì´ ë°”ê¿”ì¤ë‹ˆë‹¤.

```bash
$ExecStart=/usr/lib/bluetooth/bluetoothd -C
```


ì„¤ì •íŒŒì¼ì„ ë°”ê¾¸ë©´, ë°”ë¡œ ì ìš©ì´ ì•ˆë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, ì„œë¹„ìŠ¤ë¥¼ ì¬ì‹œì‘ í•´ì¤ë‹ˆë‹¤.

```bash
$sudo systemctl daemon-reload -  ì„¤ì • ìˆ˜ì •ì‚¬í•­ ì¬ë¡œë”©
$sudo systemctl restart bluetooth - ë¸”ë£¨íˆ¬ìŠ¤ ì„œë¹„ìŠ¤ ì¬ì‹¤í–‰
$sudo systemctl enable bluetooth - ì¬ë¶€íŒ… ì‹œ ì„œë¹„ìŠ¤ ìë™ ë“±ë¡
```

### 5. ë¸”ë£¨íˆ¬ìŠ¤ë¥¼ ê²€ìƒ‰ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ê¸°

ì´ì œ, ë¸”ë£¨íˆ¬ìŠ¤ë¥¼ ê²€ìƒ‰ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ì–´ì„œ ë‹¤ë¥¸ ë””ë°”ì´ìŠ¤ì—ì„œ ì°¾ì„ ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤. bluetoothctl ë¥¼ í†µí•´ì„œ ì„¤ì •í•©ë‹ˆë‹¤.

```bash
bluetoothctl
```

í•´ë‹¹ ëª…ë ¹ì–´ë¥¼ ì¹˜ë©´ ë¸”ë£¨íˆ¬ìŠ¤ ì„¤ì •ì„ ì¡°ì‘í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.

```bash
power on
agent on
discoverable on 
pairable on
```

ìœ„ì˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬, ë¸”ë£¨íˆ¬ìŠ¤ë¥¼ ì‚¬ìš©í• ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.

### 6. íŒŒì´ì¬ ì½”ë“œ ì§œê¸°

ì´ì œ, íŒŒì´ì¬ ì½”ë“œë¥¼ ì§œì•¼ í•©ë‹ˆë‹¤. í´ë˜ì‹ ë¸”ë£¨íˆ¬ìŠ¤í†µì‹ ì„ êµ¬í˜„í•  ìˆ˜ ìˆë„ë¡ íŒŒì´ì¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜ í•©ë‹ˆë‹¤.

```bash
$sudo pip3 install pybluez pybleno
```

ë§Œì•½ pip ì •ì±…ì˜ ë³€ê²½ìœ¼ë¡œ ìœ„ ì½”ë“œê°€ ì‹¤í–‰ì´ ì•ˆëœë‹¤ë©´, ë‹¤ìŒ ì½”ë“œë¥¼ ì…ë ¥í•˜ì‹œë©´ ë©ë‹ˆë‹¤.

```bash
pip install git+https://github.com/pybluez/pybluez.git
```

ê·¸ëŸ¬ë©´, ì €í¬ê°€ ë§Œë“  ê°€ìƒí™˜ê²½ `temp` í´ë” ì•ˆì— ì˜ì¡´ì„±ë“¤ì´ ëª¨ë‘ ì„¤ì¹˜ê°€ ë˜ì—ˆì„ ê²ë‹ˆë‹¤.

`temp` í´ë” ì•ˆì— íŒŒì´ì¬ íŒŒì¼ì„ í•˜ë‚˜ ë„£ì–´ì£¼ê³ , ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì§­ë‹ˆë‹¤. ì—¬ê¸°ì„œ ì£¼ì˜í•´ì•¼í•  ê²ƒì€ UUID ì…ë‹ˆë‹¤.

UUID ëŠ” ë²”ìš© ê³ ìœ  ë„˜ë²„ë¼ê³  ë¶ˆë¦¬ë©°, ì¼ì¢…ì˜ í†µì‹ ì„ ìœ„í•œ í”„ë¡œí† ì½œì´ë¼ê³  ìƒê°í•˜ì‹œë©´ ë©ë‹ˆë‹¤. ê° ì„œë¹„ìŠ¤ë§ˆë‹¤ UUIDê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì—, ì£¼ì˜í•˜ì—¬ ê¸°ì…í•´ì•¼ í•©ë‹ˆë‹¤. ë³¸ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì‹œë¦¬ì–¼ í¬íŠ¸ UUIDë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

```
uuid = "00001101-0000-1000-8000-00805f9b34fb"
```

ë‹¤ìŒì€, íŒŒì´ì¬ ì½”ë“œ ì…ë‹ˆë‹¤.

```python
from bluetooth import *
import time  # Import the time module to use sleep

def receiveMsg():
    uuid = "00001101-0000-1000-8000-00805f9b34fb"
 
    # RFCOMM í¬íŠ¸ë¥¼ í†µí•´ ë°ì´í„° í†µì‹ ì„ í•˜ê¸° ìœ„í•œ ì¤€ë¹„    
    server_sock = BluetoothSocket(RFCOMM)
    server_sock.bind(('', PORT_ANY))
    server_sock.listen(1)
 
    port = server_sock.getsockname()[1]
 
    # ë¸”ë£¨íˆ¬ìŠ¤ ì„œë¹„ìŠ¤ë¥¼ Advertise
    advertise_service(server_sock, "BtChat",
                      service_id=uuid,
                      service_classes=[uuid, SERIAL_PORT_CLASS],
                      profiles=[SERIAL_PORT_PROFILE])
    
    print("Waiting for connection: channel %d" % port)
    # í´ë¼ì´ì–¸íŠ¸ê°€ ì—°ê²°ë  ë•Œê¹Œì§€ ëŒ€ê¸°
    client_sock, client_info = server_sock.accept()
    print('Accepted connection from', client_info)

    try:
        while True:
            print("start")

            # Sending data to the client every 1 second
            message = "Hello from server"
            client_sock.send(message)
            print(f"Sent: {message}")

            # Wait for 1 second before sending the next message
            time.sleep(1)
 
    except KeyboardInterrupt:
        print("Disconnected")
    except BluetoothError as e:
        print(f"Bluetooth Error {e}")
    except OSError as o:
        print(f" OSError {o}")
    finally:
        client_sock.close()
        server_sock.close()
        print("All done")

receiveMsg()
```

ìœ„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ ë©ë‹ˆë‹¤. ë§Œì•½, í•´ë‹¹ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰ì‹œì¼°ëŠ”ë°, `Permission Denied` ë¼ëŠ” ì—ëŸ¬ê°€ ëœ¬ë‹¤ë©´, sudo ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰ì‹œì¼œì¤˜ì•¼ í•©ë‹ˆë‹¤. ê°€ìƒí™˜ê²½ì´ ë¸”ë£¨íˆ¬ìŠ¤ëª¨ë“ˆì— ì§ì ‘ ì ‘ê·¼í•  ê¶Œí•œì´ ì—†ê¸° ë•Œë¬¸ì— ë°œìƒí•˜ëŠ” ë¬¸ì œ ì…ë‹ˆë‹¤.

```bash
sudo python3 /yourDirectory/script.py
```

### ì‹¤í–‰

ìœ„ ê³¼ì •ì„ ëª¨ë‘ í•˜ì˜€ë‹¤ë©´, ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤ìƒì‹œí‚µë‹ˆë‹¤. ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´, ì €í¬ê°€ ì°ì–´ë†“ì•˜ë˜ ë¡œê·¸ëŒ€ë¡œ `Waiting for connection: channel 1` ì´ë¼ëŠ” ë¬¸êµ¬ê°€ ëœ° ê²ƒì…ë‹ˆë‹¤.

ì´ì œ, í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì ‘ì†ì„ ì‹œë„í•˜ë©´, ë°˜ì‘í•˜ì—¬ ì‘ë™í•  ê²ƒì…ë‹ˆë‹¤.

ğŸ‘‰ğŸ‘‰ğŸ‘‰[ì°¸ê³  ë¸”ë¡œê·¸]](https://diymaker.tistory.com/124)

## í´ë¼ì´ì–¸íŠ¸ ì„¸íŒ…í•˜ê¸°

ë¸”ë£¨íˆ¬ìŠ¤ í´ë˜ì‹ ì„œë²„ì˜ ì¤€ë¹„ë¥¼ ë§ˆì³¤ê³ , ì´ì œëŠ” í´ë¼ì´ì–¸íŠ¸ë¥¼ ì„¸íŒ… í•©ë‹ˆë‹¤. ì´ë²ˆì— ë§¡ì€ í”„ë¡œì íŠ¸ëŠ” Winform ìœ¼ë¡œ ì‘ì—…í•˜ê³  ìˆê¸°ì—, C# í´ë¼ì´ì–¸íŠ¸ë¥¼ ì¤€ë¹„ í•©ë‹ˆë‹¤. 

ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” 32feet ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

```cs
using InTheHand.Net.Sockets;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace MotionMaestro_ver._1.Forms
{
    public partial class BL_Test : Form
    {
        // Bluetooth í†µì‹  ê´€ë ¨ ë©¤ë²„
        private BluetoothClient bluetoothClient;
        private StreamReader reader;
        private StreamWriter writer;

        // ìˆ˜ì‹  ë£¨í”„ë¥¼ ê³„ì† ëŒë¦´ì§€ ì—¬ë¶€
        private bool isReading = false;

        public BL_Test()
        {
            InitializeComponent();
        }

        private void ConnectBluetooth()
        {
            try
            {
                // ê¸°ì¡´ ì—°ê²°ì´ ì—´ë ¤ ìˆìœ¼ë©´ ë¨¼ì € ì •ë¦¬
                DisconnectBluetooth();

                // ìƒˆ í´ë¼ì´ì–¸íŠ¸ ìƒì„±
                bluetoothClient = new BluetoothClient();

                // ì£¼ë³€ ë¸”ë£¨íˆ¬ìŠ¤ ë””ë°”ì´ìŠ¤ ê²€ìƒ‰
                var devices = bluetoothClient.DiscoverDevices();
                bool found = false;

                foreach (var device in devices)
                {
                    if (device.DeviceName == "raspberrypi") // Raspberry Piì˜ Bluetooth ì´ë¦„
                    {
                        textBox1.AppendText($"[INFO] Raspberry Pi ì°¾ìŒ: {device.DeviceAddress}\r\n");

                        // SerialPort í”„ë¡œí•„ë¡œ ì—°ê²°
                        Guid guid = new Guid("00001101-0000-1000-8000-00805f9b34fb");
                        //Guid guid = new Guid("94f39d29-7d6d-437d-973b-fba39e49d4ee");
                        bluetoothClient.Connect(device.DeviceAddress, guid);
                        if (bluetoothClient.Connected)
                        {
                            textBox1.AppendText("[INFO] ë¼ì¦ˆë² ë¦¬íŒŒì´ì— ë¸”ë£¨íˆ¬ìŠ¤ ì—°ê²° ì„±ê³µ!\r\n");

                            // ìŠ¤íŠ¸ë¦¼ ì–»ê¸°
                            var stream = bluetoothClient.GetStream();
                            reader = new StreamReader(stream);
                            writer = new StreamWriter(stream);
                            // ìë™ Flush ì„¤ì • (ë§¤ë²ˆ Write ì‹œì ì— ì‹¤ì œë¡œ ì „ì†¡)
                            writer.AutoFlush = true;

                            // ì—°ê²° ì„±ê³µí•˜ë©´ ë¹„ë™ê¸°ë¡œ ìˆ˜ì‹  ì‹œì‘
                            isReading = true;
                            ReceiveDataAsync();

                            found = true;
                            break; // ì›í•˜ëŠ” ë””ë°”ì´ìŠ¤ë¥¼ ì°¾ì•˜ìœ¼ë¯€ë¡œ ë°˜ë³µ ì¢…ë£Œ
                        }
                    }
                }

                if (!found)
                {
                    textBox1.AppendText("[WARN] 'raspberrypi' ë¸”ë£¨íˆ¬ìŠ¤ ê¸°ê¸°ë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.\r\n");
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Error: {ex.Message}");
            }
        }

        /// <summary>
        /// ë¹„ë™ê¸°ë¡œ Raspberry Pië¡œë¶€í„° ë°ì´í„°ë¥¼ ê³„ì† ìˆ˜ì‹ í•©ë‹ˆë‹¤.
        /// </summary>
        private async void ReceiveDataAsync()
        {
            try
            {
                while (isReading && bluetoothClient != null && bluetoothClient.Connected)
                {
                    // ReadLineAsync()ëŠ” '\n' ê¸°ì¤€ìœ¼ë¡œ í•œ ì¤„ì„ ì½ì–´ì˜´
                    string data = await reader.ReadLineAsync();

                    // ìƒëŒ€ë°©ì´ ì†Œì¼“ì„ ëŠì—ˆê±°ë‚˜, null/ë¹ˆ ë¬¸ìì—´ì´ ë“¤ì–´ì˜¤ë©´ ì¢…ë£Œë¡œ ê°„ì£¼
                    if (string.IsNullOrEmpty(data))
                    {
                        textBox1.AppendText("[INFO] ì—°ê²°ì´ ì¢…ë£Œëœ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.\r\n");
                        break;
                    }

                    // UI ìŠ¤ë ˆë“œì— ì•ˆì „í•˜ê²Œ ë°˜ì˜
                    Invoke(new Action(() =>
                    {
                        textBox1.AppendText($"[ìˆ˜ì‹ ] {data}\r\n");
                    }));
                }
            }
            catch (Exception ex)
            {
                // ì—°ê²°ì´ ëŠì–´ì§€ê±°ë‚˜ ì†Œì¼“ì´ ë‹«íˆë©´ ì˜ˆì™¸ ë°œìƒ
                Invoke(new Action(() =>
                {
                    MessageBox.Show($"ìˆ˜ì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {ex.Message}");
                }));
            }
            finally
            {
                // ë£¨í”„ ì¢…ë£Œ ì‹œë„ ì‹œ
                isReading = false;
            }
        }

        /// <summary>
        /// í˜„ì¬ ì—°ê²°ê³¼ ìì›ì„ ì •ë¦¬í•©ë‹ˆë‹¤.
        /// </summary>
        private void DisconnectBluetooth()
        {
            isReading = false;

            if (reader != null)
            {
                reader.Dispose();
                reader = null;
            }
            if (writer != null)
            {
                writer.Dispose();
                writer = null;
            }
            if (bluetoothClient != null)
            {
                if (bluetoothClient.Connected)
                {
                    bluetoothClient.Close();
                }
                bluetoothClient = null;
            }
        }

        /// <summary>
        /// "ë””ë°”ì´ìŠ¤ ì°¾ê¸°" ë²„íŠ¼ í´ë¦­ -> ConnectBluetooth()
        /// </summary>
        private void buttonFindDevice_Click(object sender, EventArgs e)
        {
            ConnectBluetooth();
        }
    }
}

```